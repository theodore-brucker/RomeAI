import requests
import json

#Input: A hosts vendor, product, and version
#Output: List of cves from NVD that affect the host
def get_vulnerabilities(host_vendor, host_product, host_version):
    api_key = 'e4190cd8-cad5-4e15-9cb0-dc48cd3bcdbd' #NVD API
    host_cves = [] #List of all cves

    #Craft and make the API request
    cpe = f"cpe:2.3:o:{host_vendor}:{host_product}:{host_version}:*:*:*:*:*:*:*"  
    url = f"https://services.nvd.nist.gov/rest/json/cves/2.0?cpeName={cpe}"
    response = requests.get(url)

    #Handle the response JSON object
    if response.status_code == 200:
        response_data = json.loads(response.text)
        vuln_data = response_data['vulnerabilities']

        #For each vulnerability in the vulnerabilities list
        for index in range(len(vuln_data)):
            #Append the cve's id 
            host_cves.append(vuln_data[index]['cve']['id'])
    else:
        print(f'Request failed with status code {response.status_code}')

    return host_cves